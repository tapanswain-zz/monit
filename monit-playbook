#!/usr/bin/ansible-playbook 
---
### ---------------------------------------------------------------------
### playbooks/monit config
### ---------------------------------------------------------------------
###
###    1. copy source from monit site.
###    2. untar the source.
###    3. copy the configuration file.
###    4. run monit
###   
###
### ---------------------------------------------------------------------
- hosts: "{{ hosts }}"
  user: root
  serial: 1
  gather_facts: false

  tasks:
    # ---------------------------------------------------------------------
    # 1.  Install monit 
    # ---------------------------------------------------------------------
     - name: "Install monit"
       yum:
         state: present
         name: monit

    # ---------------------------------------------------------------------
    # 2. copy the configuration file
    # ---------------------------------------------------------------------
     - name: "copy the config file"
       template: 
         src: "monitrc"
         dest: "/etc/monitrc"
         mode: 0700

    # ---------------------------------------------------------------------
    # 3. Start Monit
    # ---------------------------------------------------------------------
     - name: "start monit"
       service: started
       name: "monit"
       enabled: "yes"

